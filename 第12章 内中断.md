1. 任何一个通用的CPU，比如8086，都具备一种能力，可以在执行完当前正在执行的指令之后，检测到从CPU外部发送过来的或内部产生的一种特殊信息，并且可以立即对接收到的信息进行处理，这种特殊信息，称其为：中断信息。中断的意思是值，CPU不再接着（刚执行完的指令）向下执行，而是转去处理这个特殊信息。中断信息可以来自CPU的内部和外部，分别是**内中断和外中断**。

2. 内中断的产生来源

   1. 除法错误，比如，执行div指令产生的除法溢出。
   2. 单步执行
   3. 执行into指令
   4. 执行int指令

   8086CPU用称为**中断类型码**的数据来标识中断信息的来源。中断类型码为一个字节型数据，可以表示256种中断信息的来源，中断信息的来源，简称为**中断源**。中断类型码举例如下：

   除法错误：0

   单步执行：1

   执行into指令：4

   执行int指令：该指令的格式为int n，n为字节型立即数，是提供给CPU的中断类型码

3. 中断处理程序：用来处理中断信息的程序被称为中断处理程序，可由用户指定。

4. 中断向量表就是中断处理程序入口地址的列表。中断向量表在内存中保存，其中存放着256个中断源所对应的中断处理程序的入口，CPU通过中断类型码，查找中断向量表，就可以找到中断处理程序的入口地址。对于8086机，中断向量表指定放在内存地址0处。从内存地址0000:0000到0000:03FF的1024个单元中。

5. 中断向量表的一个表项存放一个中断向量，也就是一个中断处理程序的入口地址，对于8086CPU，这个入口地址包括段地址和偏移地址，所以一个表项占两个字。高地址字放段地址，低地址字放偏移地址。

6. 8086CPU收到中断信息后，所引发的中断过程：

   1. 从中断信息中取得中断类型码
   2. 标志寄存器的值入栈（因为在中断过程中，要改变标志寄存器的值）
   3. 设置标志寄存器的第8位TF和第9位IF的值为0
   4. CS的内容入栈
   5. IP的内容入栈
   6. 从内存地址为中断类型码 * 4和中断类型码 * 4 + 2的两个字单元中读取中断处理程序的入口地址设置IP和CS。

7. 中断处理程序必须始终存储在内存某段空间之中，而中断处理程序的入口地址，即中断向量，必须存储在对应的中断向量表表项中。中断处理程序的编写方法和子程序比较类似，常规步骤为：

   1. 保存用到的寄存器
   2. 处理中断
   3. 恢复用到的寄存器
   4. 用iret指令返回

   iret指令的功能用汇编语法描述为：

   ```assembly
   pop IP
   pop CS
   popf
   ```

   iret指令通常和硬件自动完成的中断过程配合使用，中断时，寄存器的入栈顺序是：标志寄存器、CS、IP。而iret的出栈顺序是IP、CS、标志寄存器。

8. `-`是编译器识别的运算符号，编译器可以用它来进行**两个常数**的减法。

9. CPU在执行完一条指令之后，如果检测到标志寄存器的TF位为1，则产生单步中断，引发中断过程。单步中断的中断类型是1，它引发的中断过程为：

   1. 取得中断类型码1
   2. 标志寄存器入栈，TF、IF置为0
   3. CS、IP入栈
   4. (IP)=(1\*4),(CS)=(1\*4+2)

10. 一般情况下，CPU在执行完当前指令之后，如果监测到中断信息，就响应中断，引发中断过程。但是，在某些情况下。CPU执行完当前命令后，即便发生中断，也不会响应。

    在执行完向ss寄存器传送数据的指令后，即便是发生了中断，CPU也不会响应。主要是因为ss:sp联合指向栈顶，而对它们的设置应该连续完成。

   

   















